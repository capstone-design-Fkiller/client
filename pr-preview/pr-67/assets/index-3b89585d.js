import{c as o,a as N,r as k,j as r,b as i,l as R,u as j,f as q,d as P,P as D}from"./index-c1d704d5.js";import{B as L}from"./index-46917494.js";import{I as E,M as w,P as G,a as V}from"./index-9c037ae0.js";import{S as z}from"./index-be01ce36.js";import{S as W}from"./index-c026cbe1.js";import{B as O}from"./building-925df4bd.js";import{u as H}from"./useInput-d31e6e57.js";import{d as I,e as X,f as $}from"./locker-9630e6d8.js";import{u as K}from"./major-df3ac193.js";const J=o("section",{target:"e1a6068d3"})("display:flex;flex-direction:column;justify-content:center;padding:0 30px;",({theme:e})=>N("min-height:calc(var(--vh, 1vh) * 100 - ",e.layouts.fixedHeight,");",""),";"),U=o("div",{target:"e1a6068d2"})("display:grid;grid-template-rows:350px 1fr;width:100%;height:450px;background-color:",({theme:e})=>e.colors.white_300,";border:1px solid ",({theme:e})=>e.colors.light_grey_100,";border-radius:5px;margin-bottom:30px;"),Q=o("div",{target:"e1a6068d0"})("display:flex;flex-direction:column;justify-content:space-evenly;align-items:flex-start;width:100%;padding:0 10px;border-top:1px solid ",({theme:e})=>e.colors.light_grey_100,";background-color:",({theme:e})=>e.colors.background_2,";&>div{display:flex;align-items:center;width:100%;height:24px;&:last-of-type{padding:0 10px;}}"),Y=e=>{const{majorInfo:a,setValue:u,handleApplyButton:s}=e,[y,d]=k.useState(!0);if(!a)return r("span",{children:"추가 조건이 없습니다!"});const h=Object.entries(a).filter(([n,l])=>l&&n!=="is_baserule_FCFS"),t=(n,l)=>{let g;if(n.target.type==="checkbox")g=n.target.checked||!1;else{const c=Number(n.target.value);c<0?(alert("0 이상인 값만 입력 가능합니다."),n.target.value=""):g=c}u(c=>{const _={...{...c},[`${l}_answer`]:g},b=h.every(([f])=>{const x=_[`priority_${f}_answer`];return x!=null&&x!==""});return d(!b),_})};return i(m.Root,{children:[i("div",{children:[i(m.Description,{children:["동점자는 ",a.is_baserule_FCFS?"선착순":"랜덤"," 우선배정됩니다 😊"]}),r("br",{}),h.length?h.map(([n,l],g)=>i(m.ConditionWrapper,{children:[i(m.Name,{children:[g+1,"순위: ",l.name]}),l.is_bool?i(m.Label,{children:[r(m.Input,{type:"checkbox",onChange:c=>t(c,n)}),r("span",{className:"slider"})]}):r(m.Input,{type:"number",placeholder:l.question,onChange:c=>t(c,n)})]},n)):null]}),r(L,{variant:"contained",onClick:s,disabled:y,children:"신청"})]})},m={Root:o("div",{target:"euooqhp5"})({name:"14ggdrv",styles:"height:100%;display:flex;flex-direction:column;justify-content:space-between"}),ConditionWrapper:o("div",{target:"euooqhp4"})({name:"r3aoht",styles:"width:100%;margin-bottom:25px"}),Name:o("div",{target:"euooqhp3"})({name:"oub90b",styles:"margin-bottom:10px;font-size:15px"}),Label:o("label",{target:"euooqhp2"})("position:relative;display:inline-block;width:60px;height:29px;& input{opacity:0;width:0;height:0;}& .slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;-webkit-transition:0.4s;transition:0.4s;border-radius:29px;}& .slider:before{position:absolute;content:'';height:21px;width:21px;left:4px;bottom:4px;background-color:white;-webkit-transition:0.4s;transition:0.4s;border-radius:50%;}& input:checked+.slider{background-color:",({theme:e})=>e.colors.primary_200,";}& input:focus+.slider{box-shadow:0 0 1px ",({theme:e})=>e.colors.primary_300,";}& input:checked+.slider:before{-webkit-transform:translateX(31px);-ms-transform:translateX(31px);transform:translateX(31px);}"),Input:o("input",{target:"euooqhp1"})({name:"1l2d352",styles:"width:100%;padding:10px 5px;&::placeholder{font-size:14px;}"}),Description:o("p",{target:"euooqhp0"})("color:",({theme:e})=>e.colors.grey_300,";font-size:15px;text-align:center;")},T={not_building:"건물을 선택해주세요.",not_login:"로그인 후 사용할 수 있습니다!"},Z=e=>{const{me:a,value:u,total:s,applyCount:y}=e,d=R();if(!a||!s){const t=a?T.not_building:T.not_login;return i(p.Root,{children:[r(E,{iconName:"nothing",size:"100",color:d.colors.grey_200,hasCursor:!1}),r("span",{style:{color:d.colors.grey_200},children:t})]})}const h=Math.ceil(y/s*100);return i(p.Root,{children:[r(p.GradientWrapper,{children:i(p.Building,{grd:h>100?100:h,children:[r(p.Floor,{}),r(p.Floor,{}),r(p.Floor,{}),r(p.Floor,{}),r(p.Floor,{})]})}),i(p.Title,{children:[u," ( ",y," / ",s," )"]})]})},p={Root:o("div",{target:"e166tayl4"})({name:"l768v7",styles:"display:flex;flex-direction:column;justify-content:center;align-items:center;gap:20px;width:100%"}),Building:o("div",{target:"e166tayl3"})("display:grid;grid-template-rows:repeat(5, 1fr);border-radius:5px;",({grd:e})=>N("height:",100-e,"%;background:white;",""),";"),GradientWrapper:o("div",{target:"e166tayl2"})({name:"1ncgd1x",styles:"background-color:#2cb67d"}),Floor:o("div",{target:"e166tayl1"})("width:100px;height:50px;background-color:transparent;border:5px solid ",({theme:e})=>e.colors.light_grey_200,";"),Title:o("h1",{target:"e166tayl0"})("")},ee=(e=!1)=>{const[a,u]=k.useState(e);return{open:a,handleOpen:()=>u(!a),setOpen:u}},pe=()=>{var S,F,A;const{me:e}=j(),{open:a,handleOpen:u}=ee(),{createToastMessage:s}=q(),y=P();if(!e)return s("로그인을 다시 해주세요!","error"),y(D.LOGIN),r("div",{});const[d,h]=k.useState("건물"),{majorInfo:t}=K(w[e.major],!0),{value:n,setValue:l}=H({priority_1_answer:((S=t==null?void 0:t.priority_1)==null?void 0:S.is_bool)&&!1,priority_2_answer:((F=t==null?void 0:t.priority_2)==null?void 0:F.is_bool)&&!1,priority_3_answer:((A=t==null?void 0:t.priority_3)==null?void 0:A.is_bool)&&!1}),{applicableBuildings:g}=I(w[e.major]),{mutate:c}=X(),C=v=>h(v.currentTarget.innerText),{data:{apply:_,lockerCounts:b}}=$({major:w[e.major],building_id:O[d]}),f=()=>{if(!e)return s("로그인 후 사용해주세요!","error");if(!(b!=null&&b.length))return s("해당 건물에는 사물함이 없습니다!","error");t||x(),u()},x=()=>{var v,B,M;c({building_id:O[d],major:w[e.major],user:e.id,...n}),l({priority_1_answer:((v=t==null?void 0:t.priority_1)==null?void 0:v.is_bool)&&!1,priority_2_answer:((B=t==null?void 0:t.priority_2)==null?void 0:B.is_bool)&&!1,priority_3_answer:((M=t==null?void 0:t.priority_3)==null?void 0:M.is_bool)&&!1}),f()};return i(G,{children:[i(J,{children:[i(U,{children:[r(Z,{me:e,value:d,total:b?b.length:void 0,applyCount:_?_.length:void 0}),i(Q,{children:[r(z,{value:d,handleChange:C,list:g}),r(W,{}),r("div",{children:e.major||"학과"})]})]}),r(L,{variant:"contained",onClick:f,children:"신청하기"})]}),r(V,{title:"학과별 조건 입력",open:a,onClose:f,children:e&&r(Y,{majorInfo:t,setValue:l,handleApplyButton:x})})]})};export{pe as default};
