import{m as l,i as r,f as n,g as u,e as d,h as p}from"./index-8816104c.js";const y=async a=>{const{data:e}=await l.get("http://127.0.0.1:8000/locker",{params:a});return e},k=async a=>{const{data:e}=await l.get("http://127.0.0.1:8000/apply",{params:a});return e},g=async a=>{const{data:e}=await r.post("apply/",a);return e},h=async a=>{const{data:e}=await r.get(`locker/?owned_id=${a}`);if(console.log(e,"owned id - 배정된 사물함"),e.length==0){const{data:t}=await r.get(`locker/?shared_id=${a}`);return console.log(t,"shared_id - 쉐어받은 사물함"),t}return e},m=async a=>{const{data:e}=await l.get(`http://127.0.0.1:8000/locker?major=${a}&is_share_registered=True`);return e},o={apply:"apply",locker:"locker",myLocker:"myLocker",share:"share"},b=a=>{const e=Object.values(a),{data:t}=n([o.locker,"locker-counts",...e],()=>y(a),{enabled:!!a.building_id&&!!a.major}),{data:s}=n([o.apply,"applicant",...e],()=>k(a),{enabled:!!a.building_id&&!!a.major});return{data:{apply:s,lockerCounts:t}}},w=()=>{const a=u(),{createToastMessage:e}=d();return p(s=>g(s),{onSuccess:({major:s,building_id:c})=>{e("신청 완료 !","success"),a.invalidateQueries([o.apply,"applicant",s,c])},onError:()=>{e("다시 시도해주세요.","error")}})},_=a=>{const{data:e}=n([o.myLocker],()=>h(a));return{data:e}},M=a=>{const{data:e,isLoading:t}=n([o.locker,o.share,"sharable-lockers",a],()=>m(a),{enabled:!!a,onSuccess:s=>{const c=new Date;return s.filter(({end_date:i})=>i&&new Date(i)>c)}});return{sharableLockers:e,isLoading:t}};export{_ as a,w as b,b as c,M as u};
