import{n as l,i as r,g as o,h as u,f as d,k}from"./index-0e1d83f5.js";const p=async a=>{const{data:t}=await l.get("http://127.0.0.1:8000/locker",{params:a});return t},y=async a=>{const{data:t}=await l.get("http://127.0.0.1:8000/apply",{params:a});return t},g=async a=>{const{data:t}=await r.post("apply/",a);return t},h=async a=>{const{data:t}=await r.get(`locker/?owned_id=${a}`);if(console.log(t,"owned id - 배정된 사물함"),t.length==0){const{data:e}=await r.get(`locker/?shared_id=${a}`);return console.log(e,"shared_id - 쉐어받은 사물함"),e}return t},m=async a=>{const{data:t}=await l.get(`http://127.0.0.1:8000/locker?major=${a}&is_share_registered=True`);return t},n={apply:"apply",locker:"locker",myLocker:"myLocker",share:"share"},b=a=>{const t=Object.values(a),{data:e}=o([n.locker,"locker-counts",...t],()=>p(a),{enabled:!!a.building_id&&!!a.major}),{data:s}=o([n.apply,"applicant",...t],()=>y(a),{enabled:!!a.building_id&&!!a.major});return{data:{apply:s,lockerCounts:e}}},w=()=>{const a=u(),{createToastMessage:t}=d();return k(s=>g(s),{onSuccess:({major:s,building_id:c})=>{t("신청 완료 !","success"),a.invalidateQueries([n.apply,"applicant",s,c])},onError:()=>{t("다시 시도해주세요.","error")}})},_=a=>{const{data:t}=o([n.myLocker],()=>h(a));return{data:t}},M=a=>{const{data:t,isLoading:e}=o([n.locker,n.share,"sharable-lockers",a],()=>m(a),{enabled:!!a,onSuccess:s=>{const c=new Date;return s.filter(({end_date:i})=>i&&new Date(i)>c)}});return{sharableLockers:t,isLoading:e}};export{_ as a,w as b,b as c,M as u};
