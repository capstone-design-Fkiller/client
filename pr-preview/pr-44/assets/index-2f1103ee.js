import{c as a,a as w,b as t,j as c,d as S,r as I,i as O,g as T,u as N,h as B,e as F,P as R}from"./index-4d655461.js";import{B as M}from"./index-6cbce2e5.js";import{I as A,P as E,M as L}from"./index-0b6dc99d.js";import{a as P,M as f,b as q,B as v,S as G}from"./locker-8dcf43d4.js";import{u as V}from"./useInput-cac2ac8e.js";const W=a("section",{target:"e1a6068d4"})("display:flex;flex-direction:column;justify-content:center;padding:0 30px;",({theme:e})=>w("min-height:calc(var(--vh, 1vh) * 100 - ",e.layouts.fixedHeight,");",""),";"),H=a("div",{target:"e1a6068d3"})("display:grid;grid-template-rows:350px 1fr;width:100%;height:450px;background-color:",({theme:e})=>e.colors.white_300,";border:1px solid ",({theme:e})=>e.colors.light_grey_100,";border-radius:5px;margin-bottom:30px;"),K=a("div",{target:"e1a6068d1"})("display:flex;flex-direction:column;justify-content:space-evenly;align-items:flex-start;width:100%;padding:0 10px;border-top:1px solid ",({theme:e})=>e.colors.light_grey_100,";background-color:",({theme:e})=>e.colors.background_2,";&>div{display:flex;align-items:center;width:100%;height:24px;&:last-of-type{padding:0 10px;}}"),Q=a("hr",{target:"e1a6068d0"})("width:100%;height:1px;padding-left:10px;border:0;background:",({theme:e})=>e.colors.light_grey_200,";"),U=e=>{const{majorInfo:o,setValue:l,handleApplyButton:r}=e;if(!o)return t("span",{children:"추가 조건이 없습니다!"});const d=Object.entries(o).filter(([,n])=>n),i=(n,p)=>{const u=n.currentTarget.value;l(m=>({...{...m},[p]:Number(u)===1?!0:Number(u)===0?!1:Number(u)}))};return c(h.Root,{children:[t("div",{children:d.map(([n,p])=>c(h.ConditionWrapper,{children:[t(h.Name,{children:p}),t(h.Input,{placeholder:"입력해라",onChange:u=>i(u,n)})]},n))}),t(M,{variant:"contained",onClick:r,children:"신청"})]})},h={Root:a("div",{target:"euooqhp3"})({name:"14ggdrv",styles:"height:100%;display:flex;flex-direction:column;justify-content:space-between"}),ConditionWrapper:a("div",{target:"euooqhp2"})({name:"1ew5ocq",styles:"width:100%;margin-bottom:15px"}),Name:a("div",{target:"euooqhp1"})({name:"pr10xp",styles:"margin-bottom:10px"}),Input:a("input",{target:"euooqhp0"})({name:"1terk8e",styles:"width:100%;padding:10px 5px"})},C={not_building:"건물을 선택해주세요.",not_login:"로그인 후 사용할 수 있습니다!"},Y=e=>{const{me:o,value:l,total:r,applyCount:d}=e,i=S();if(!o||!r){const p=o?C.not_building:C.not_login;return c(s.Root,{children:[t(A,{iconName:"nothing",size:"100",color:i.colors.grey_200,hasCursor:!1}),t("span",{style:{color:i.colors.grey_200},children:p})]})}const n=Math.ceil(d/r*100);return c(s.Root,{children:[t(s.GradientWrapper,{children:c(s.Building,{grd:n>100?100:n,children:[t(s.Floor,{}),t(s.Floor,{}),t(s.Floor,{}),t(s.Floor,{}),t(s.Floor,{})]})}),c(s.Title,{children:[l," ( ",d," / ",r," )"]})]})},s={Root:a("div",{target:"e166tayl4"})({name:"l768v7",styles:"display:flex;flex-direction:column;justify-content:center;align-items:center;gap:20px;width:100%"}),Building:a("div",{target:"e166tayl3"})("display:grid;grid-template-rows:repeat(5, 1fr);border-radius:5px;",({grd:e})=>w("height:",100-e,"%;background:white;",""),";"),GradientWrapper:a("div",{target:"e166tayl2"})({name:"1ncgd1x",styles:"background-color:#2cb67d"}),Floor:a("div",{target:"e166tayl1"})("width:100px;height:50px;background-color:transparent;border:5px solid ",({theme:e})=>e.colors.light_grey_200,";"),Title:a("h1",{target:"e166tayl0"})("")},$=(e=!1)=>{const[o,l]=I.useState(e);return{open:o,handleOpen:()=>l(!o),setOpen:l}},z=async e=>{const{data:o}=await O.get(`major/${e}`);return o},D={major:"major"},J=(e,o)=>{const{data:l}=T([D.major,e],()=>z(e),{enabled:!!e,select:r=>{const{priority_1:d,priority_2:i,priority_3:n}=r;return o?{priority_1:d,priority_2:i,priority_3:n}:r}});return{majorInfo:l}},re=()=>{const{me:e}=N(),{open:o,handleOpen:l}=$(),{createToastMessage:r}=B(),d=F();if(!e)return r("로그인을 다시 해주세요!","error"),d(R.LOGIN),t("div",{});const[i,n]=I.useState("건물"),{value:p,setValue:u}=V({priority_1:null,priority_2:null,priority_3:null}),{mutate:m}=P(),{majorInfo:y}=J(f[e.major],!0),b=k=>n(k.currentTarget.innerText),{data:{apply:_,lockerCounts:g}}=q({major:f[e.major],building_id:v[i]}),x=()=>{if(!e)return r("로그인 후 사용해주세요!","error");if(!(g!=null&&g.length))return r("해당 건물에는 사물함이 없습니다!","error");y||j(),l()},j=()=>{m({building_id:v[i],major:f[e.major],user:e.id,...p}),x()};return c(E,{children:[c(W,{children:[c(H,{children:[t(Y,{me:e,value:i,total:g?g.length:void 0,applyCount:_?_.length:void 0}),c(K,{children:[t(G,{value:i,handleChange:b,list:Object.keys(v).slice(1)}),t(Q,{}),t("div",{children:e.major||"학과"})]})]}),t(M,{variant:"contained",onClick:x,children:"신청하기"})]}),t(L,{title:"학과별 조건 입력",open:o,onClose:x,children:e&&t(U,{majorInfo:y,setValue:u,handleApplyButton:j})})]})};export{re as default};
