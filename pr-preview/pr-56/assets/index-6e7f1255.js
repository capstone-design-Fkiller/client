import{c as n,a as _,j as e,r as h,b as p,i as v,f as I,h as C,g as L,k,u as D,d as F,L as A,F as x,P as B}from"./index-1bd1ac65.js";import{I as z,M as m,B as H,P as N}from"./index-6a7d43e6.js";import{P as u,a as q}from"./page_offset-a8aaca05.js";import{g as Q}from"./building-34ad378b.js";import{a as O}from"./major-3349ff9d.js";const $=n("div",{target:"e1hp0tas6"})("display:flex;justify-content:center;flex-direction:column;align-items:center;padding:0 30px;",({theme:t})=>_("min-height:calc(var(--vh, 1vh) * 100 - ",t.layouts.fixedHeight,");",""),";"),Y=n("h1",{target:"e1hp0tas5"})("font-size:25px;font-weight:bold;margin-bottom:10px;color:",({theme:t})=>t.colors.primary_300,";"),G=n("div",{target:"e1hp0tas4"})("font-size:14px;font-weight:400;text-align:center;",({theme:t})=>_("color:",t.colors.primary_200,";",""),";"),J=n("table",{target:"e1hp0tas3"})("width:100%;margin-top:15px;border-collapse:collapse;& tr>td,& tr>th{padding:10px 5px;white-space:nowrap;&:first-of-type{padding-left:10px;}}& tbody tr{border-bottom:1px solid ",({theme:t})=>t.colors.light_grey_100,";}"),K=n("h1",{target:"e1hp0tas2"})({name:"r77xyq",styles:"display:flex;font-size:18px;justify-content:center;margin-top:100px;margin-bottom:100px"}),U=n("div",{target:"e1hp0tas0"})({name:"1t3ivjg",styles:"display:flex;justify-content:center;margin-bottom:20px"}),X=({contents:t,handleDelete:o})=>{const r=s=>s===null?"-":typeof s=="boolean"?s?"O":"X":s,i=s=>{confirm("정말 삭제하시겠습니까?")&&o(s)};return e("tbody",{children:t.map(s=>e(h.Fragment,{children:p(c.Row,{children:[e(c.Item,{children:s.user}),e(c.Item,{children:r(s.priority_1_answer)}),e(c.Item,{children:r(s.priority_2_answer)}),e(c.Item,{children:r(s.priority_3_answer)}),e(c.Item,{children:Q(s.building_id)}),e(c.IconItem,{onClick:()=>i(s.id),children:e(z,{iconName:"trashcan",size:"18"})})]})},s.id))})},c={Row:n("tr",{target:"efwokpf2"})("font-size:14px;padding:10px;width:100%;transition:0.1s color ease-in-out;&:hover{background-color:",({theme:t})=>t.colors.light_grey_100,";}"),Item:n("td",{target:"efwokpf1"})({name:"7lr3li",styles:"white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center"}),IconItem:n("td",{target:"efwokpf0"})("display:flex;flex-direction:column;align-items:center;cursor:pointer;&:hover svg path{stroke:",({theme:t})=>t.colors.error_100,";}")},V=t=>{const{headers:o}=t;return e(w.Head,{children:e("tr",{children:o.map(r=>e(w.Item,{children:r},r))})})},w={Head:n("thead",{target:"ens05cg1"})("width:100%;font-size:16px;font-weight:bold;background-color:",({theme:t})=>t.colors.primary_200,";border-radius:5px;"),Item:n("th",{target:"ens05cg0"})({name:"7lr3li",styles:"white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center"})},W=async t=>{const o=t||0,{data:r}=await v.get(`sort/${o}`);return r},Z=async(t,o)=>{const r=t||0,{data:i}=await v.post(`assign/${r}`,o);return i},b={sort:"sort"},tt=t=>{const{createToastMessage:o}=I(),r=C(),{data:i,isLoading:s}=L(b.sort,()=>W(t),{onError:()=>{o("오류가 발생했습니다.","error")}});return r.invalidateQueries(b.sort),{data:i,isLoading:s}},et=()=>{const{createToastMessage:t}=I();return k(({major:r,sortResult:i})=>Z(r,i),{onSuccess:()=>{t("배정 확정 완료!","success")},onError:()=>{t("다시 시도해주세요.","error")}})},rt=["학번","1st","2nd","3rd","건물","삭제"],lt=()=>{const{me:t}=D();if(!t)throw new Error;const o=F(),{data:r,isLoading:i}=tt(m[(t==null?void 0:t.major)??"학과"]),{mutate:s}=et(),[a,P]=h.useState(r),[g,S]=h.useState(1),[st,T]=h.useState(!1),{majorInfo:l}=O(m[t.major]),j=f=>{P(d=>d==null?void 0:d.filter(R=>R.id!==f))},E=()=>{const d={list:(a==null?void 0:a.map(y=>y.id))||[]};s({major:m[t.major],sortResult:d}),T(!0),o(B.MAIN)},M=l!=null&&l.apply_end_date?new Date(l==null?void 0:l.apply_end_date)<new Date:!1;return e(N,{children:p($,{children:[e(Y,{children:"사물함 배정 예상 결과"}),p(G,{children:[e("p",{children:"사물함 신청 끝나면 배정 확정 버튼이 생성됩니다."}),e("p",{children:"배정 확정 버튼을 누르면 변경이 불가합니다."})]}),i?e(A,{}):e(x,{children:r&&r.length===0?e(K,{children:"사물함 신청자가 없습니다."}):p(x,{children:[p(J,{children:[e(V,{headers:rt}),e(X,{contents:(a==null?void 0:a.slice((g-1)*u,g*u))||[],handleDelete:j})]}),e(U,{children:e(q,{currentPage:g,totalItems:(a==null?void 0:a.length)||0,itemsPerPage:u,setState:S})}),M&&e(H,{variant:"contained",color:"primary",onClick:E,children:"배정 확정하기"})]})})]})})};export{lt as default};
