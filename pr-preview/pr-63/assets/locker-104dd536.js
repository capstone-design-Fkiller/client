import{i as c,g as o,h as i,f as u,k as l,d as g,P as p}from"./index-f3b0bc45.js";import{g as k}from"./building-925df4bd.js";const y=async a=>{const{data:t}=await c.get("locker/",{params:a});return t},h=async a=>{const{data:t}=await c.get("apply/",{params:a});return t},m=async a=>{const{data:t}=await c.post("apply/",a);return t},b=async a=>{const{data:t}=await c.get(`locker/?owned_id=${a}`);if(t.length===0){const{data:e}=await c.get(`locker/?shared_id=${a}`);return e[0]}return t[0]},w=async a=>{const{data:t}=await c.get(`locker/building/?major=${a}`);return t},L=async a=>{const{id:t,...e}=a,{data:s}=await c.patch(`locker/${t}`,{...e});return s},M=async a=>{const{data:t}=await c.get(`locker/sharable/?major=${a}&is_share_registered=True`);return t},A=async a=>{const{id:t,shared_id:e}=a,{data:s}=await c.patch(`locker/${t}`,{shared_id:e});return s},r={apply:"apply",locker:"locker",share:"share"},C=a=>{const t=Object.values(a),{data:e}=o([r.locker,"locker-counts",...t],()=>y(a),{enabled:!!a.building_id&&!!a.major}),{data:s}=o([r.apply,"applicant",...t],()=>h(a),{enabled:!!a.building_id&&!!a.major});return{data:{apply:s,lockerCounts:e}}},_=()=>{const a=i(),{createToastMessage:t}=u();return l(s=>m(s),{onSuccess:({major:s,building_id:n})=>{t("신청 완료 !","success"),a.invalidateQueries([r.apply,"applicant",s,n])},onError:()=>{t("다시 시도해주세요.","error")}})},f=a=>{const{data:t}=o([r.locker,a],()=>b(a));return{myLocker:t}},N=a=>{const{data:t}=o(["building",a],()=>w(a));return{applicableBuildings:(t==null?void 0:t.map(s=>k(s)??"건물"))??["건물"]}},Q=a=>{const{data:t,isLoading:e}=o([r.share,"sharable-lockers",a],()=>M(a),{enabled:!!a,onSuccess:s=>{const n=new Date;return s.filter(({end_date:d})=>d&&new Date(d)>n)}});return{sharableLockers:t,isLoading:e}},T=()=>{const a=i(),t=g(),{createToastMessage:e}=u();return l(n=>L(n),{onSuccess:({owned_id:n})=>{a.invalidateQueries([r.locker,n]),e("쉐어 여부 변경 완료 !","success"),t(p.MAIN)},onError:()=>e("다시 시도해주세요.","error")})},$=()=>{const a=i(),t=g(),{createToastMessage:e}=u();return l(n=>A(n),{onSuccess:({shared_id:n})=>{a.invalidateQueries([r.locker,n]),e("쉐어 신청 완료 !","success"),t(p.MAIN)},onError:()=>e("다시 시도해주세요.","error")})};export{Q as a,$ as b,T as c,N as d,_ as e,C as f,f as u};
