import{i as o,g as u,h as l,f as p,k as d,d as g,P as k}from"./index-2963321b.js";import{g as y}from"./building-925df4bd.js";const h=async e=>{const{data:a}=await o.get("locker/",{params:e});return a},m=async e=>{const{data:a}=await o.get("apply/",{params:e});return a},b=async(e,a)=>{const{data:t}=await o.get("apply/",{params:{major:e,user:a}});return t[0]},w=async e=>{const{data:a}=await o.post("apply/",e);return a},C=async e=>{const{data:a}=await o.get(`locker/?owned_id=${e}`);if(a.length===0){const{data:t}=await o.get(`locker/?shared_id=${e}`);return t[0]}return a[0]},L=async e=>{const{data:a}=await o.get(`locker/building/?major=${e}`);return a},v=async e=>{const{id:a,...t}=e,{data:n}=await o.patch(`locker/${a}`,{...t});return n},A=async()=>{const{data:e}=await o.get("locker/sharable/?is_share_registered=True");return e},M=async e=>{const{id:a,shared_id:t}=e,{data:n}=await o.patch(`locker/${a}`,{shared_id:t});return n},r={apply:"apply",applyCheck:"applyCheck",locker:"locker",share:"share"},Q=e=>{const a=Object.values(e),{data:t}=u([r.locker,"locker-counts",...a],()=>h(e),{enabled:!!e.building_id&&!!e.major}),{data:n}=u([r.apply,"applicant",...a],()=>m(e),{enabled:!!e.building_id&&!!e.major});return{data:{apply:n,lockerCounts:t}}},T=(e,a)=>{const{data:t}=u([r.applyCheck],()=>b(e,a));return{data:t}},_=e=>{const{data:a}=u([r.locker,e],()=>C(e));return{myLocker:a}},N=()=>{const e=l(),{createToastMessage:a}=p();return d(n=>w(n),{onSuccess:({major:n,building_id:s})=>{a("사물함 신청 완료 !","success"),e.invalidateQueries([r.apply,"applicant",n,s]),e.invalidateQueries([r.applyCheck])},onError:n=>{var c;const s=(c=n.response)==null?void 0:c.data;s&&a(s.message,"error")}})},E=e=>{const{data:a}=u(["building",e],()=>L(e));return{applicableBuildings:(a==null?void 0:a.map(n=>y(n)||"건물"))||["선택할 수 있는 건물이 없습니다."]}},F=()=>{const{data:e,isLoading:a}=u([r.share,"sharable-lockers"],A,{staleTime:6e3,onSuccess:t=>{const n=new Date;return t.filter(({end_date:s})=>s&&new Date(s)>n)}});return{sharableLockers:e,isLoading:a}},$=()=>{const e=l(),a=g(),{createToastMessage:t}=p();return d(s=>v(s),{onSuccess:({owned_id:s})=>{e.invalidateQueries([r.locker,s]),t("쉐어 여부 변경 완료 !","success"),a(k.MAIN)},onError:s=>{var i;const c=(i=s.response)==null?void 0:i.data;c&&t(c.message,"error")}})},j=()=>{const e=l(),a=g(),{createToastMessage:t}=p();return d(s=>M(s),{onSuccess:({id:s,owned_id:c,shared_id:i})=>{e.invalidateQueries([r.locker,s]),e.invalidateQueries([r.locker,c]),e.invalidateQueries([r.locker,i]),t("쉐어 신청 완료 !","success"),a(k.MAIN)},onError:s=>{var i;const c=(i=s.response)==null?void 0:i.data;c&&t(c.message,"error")}})};export{F as a,j as b,$ as c,T as d,E as e,N as f,Q as g,_ as u};
